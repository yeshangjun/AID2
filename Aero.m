function PT=Aero(PT,M,angl) 

%Convert to Radians if Necessary
%a0 = (PT.a0+PT.a0(end))/2;
for i=1:length(PT.a0)
    if PT.a0(i)<1, PT.a0(i)=PT.a0(i)*180/pi; end
end
a0 = (PT.a0(1) + PT.a0(end))/2;

%Lift Curve Slope (2D->3D accounting for compressibility effects)
B=sqrt(1-M^2);   %Prandtl-Gluaert Correction Factor
k=a0/(2*pi); 
AR=B*PT.AR(end)/k;    %Aspect Ratio Parameter
if angl 
    if PT.SSPNOP
        PT.AR(end)=PT.AR(end)*(PT.SSPNOP*cosd(PT.DHDADI)+...
            (PT.SSPN-PT.SSPNOP)*cosd(PT.DHDADO))/PT.SSPN;
    else
        PT.AR(end)=PT.AR(end)*cosd(PT.DHDADI);
    end
end
PT.a=2*pi*PT.AR(end)/(2+sqrt(AR^2*(1+(tand(PT.swp(3,end))/B)^2)+4));

%Fix Imaginary Values
PT.TR(end)=real(PT.TR(end));

%%%%%%%%%%%%%%%%%%%%%%%%%% Fix Alpha_0L %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%from Glenn Greiner (AE Professor at ERAU Daytona Beach)
%
%[aol_theta, aol_theta_M] = Fig_aol_theta(PT.swp(2,end), A, Taper, M, PT.TC)
%Change of zero-lift-angle (aoL) due to twist (theta), Datcom
%Figure 4.1.3.1.4 including Mach effects, Datcom Figure 4.1.3.1.6
%Input
%PT.swp(1,end) = Leading edge sweep
%A = Aspect Ratio
%PT.TR(end) = Taper ratio
%M = Subsonic Mach number
%PT.TC = Wing section Thickness to chord ratio (in percent)
%Output
%aol_theta = Change in zero-lift-angle (aol) due to twist (theta)
%aol_theta_M = Correction for compressibility effects (Mach)

%Datcomom Figure 4.1.3.1.4-A, B and C
%Taper Ratio
X3 = [0.0 ,0.5, 1.0];
%Aspect Ratio
X2 = [6.0, 3.5, 1.5];
%c/4 Sweep
X = [-45., -40., -35., -30., -25., -20., -15., ...
    -10.,  -5.,   0.,   5.,  10.,  15.,  20., ...
    25.,  30.,  35.,  40.,  45.,  50.,  55., ...
    60.];
%daol_theta
Y = {{[-0.4000,-0.4000,-0.4000,-0.4000,-0.4000,-0.4000,-0.4000, ...
    -0.4000,-0.4000,-0.4000,-0.3990,-0.3980,-0.3970,-0.3960, ...
    -0.3950,-0.3940,-0.3930,-0.3902,-0.3880,-0.3850,-0.3790, ...
    -0.3730]
    [-0.3820,-0.3820,-0.3820,-0.3820,-0.3820,-0.3820,-0.3820, ...
    -0.3820,-0.3820,-0.3820,-0.3790,-0.3770,-0.3740,-0.3720, ...
    -0.3680,-0.3660,-0.3640,-0.3600,-0.3560,-0.3500,-0.3430, ...
    -0.3350]
    [-0.3670,-0.3670,-0.3670,-0.3670,-0.3670,-0.3670,-0.3670, ...
    -0.3670,-0.3670,-0.3670,-0.3640,-0.3610,-0.3580,-0.3550, ...
    -0.3510,-0.3470,-0.3430,-0.3390,-0.3360,-0.3310,-0.3260, ...
    -0.3180]};
    
    {[-0.4120,-0.4120,-0.4120,-0.4102,-0.4120,-0.4120,-0.4120, ...
    -0.4120,-0.4120,-0.4120,-0.4110,-0.4080,-0.4070,-0.4050, ...
    -0.4020,-0.3995,-0.3980,-0.3950,-0.3930,-0.3895,-0.3860, ...
    -0.3800]
    [-0.4100,-0.4100,-0.4100,-0.4100,-0.4100,-0.4100,-0.4100, ...
    -0.4100,-0.4100,-0.4100,-0.4080,-0.4060,-0.4030,-0.4010, ...
    -0.3980,-0.3960,-0.3940,-0.3920,-0.3880,-0.3850,-0.3805, ...
    -0.3760]
    [-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080, ...
    -0.4080,-0.4080,-0.4080,-0.4070,-0.4060,-0.4060,-0.4050, ...
    -0.4040,-0.4030,-0.4020,-0.4000,-0.3980,-0.3960,-0.3930, ...
    -0.3880]};
    
    {[-0.4280,-0.4280,-0.4280,-0.4282,-0.4280,-0.4280,-0.4280, ...
    -0.4280,-0.4280,-0.4280,-0.4270,-0.4250,-0.4240,-0.4230, ...
    -0.4210,-0.4195,-0.4185,-0.4170,-0.4175,-0.4170,-0.4175, ...
    -0.4180]
    [-0.4180,-0.4180,-0.4180,-0.4180,-0.4180,-0.4180,-0.4180, ...
    -0.4180,-0.4180,-0.4180,-0.4170,-0.4160,-0.4150,-0.4140, ...
    -0.4125,-0.4105,-0.4095,-0.4085,-0.4075,-0.4165,-0.4160, ...
    -0.4150]
    [-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080, ...
    -0.4080,-0.4080,-0.4080,-0.4085,-0.4090,-0.4095,-0.4095, ...
    -0.4090,-0.4820,-0.4070,-0.4060,-0.4040,-0.4000,-0.3960, ...
    -0.3900]}};

%perform interpolation
nmY = length(X3);
nmX2 = length(X2);
Y1 = cell(size(nmY));
Y2 = zeros(size(nmX2));
for i=1:nmY
    for j=1:nmX2
        %interpolate by sweep for each graph under each aspect ratio
        %and taper ratio
        Y1{i}(j) = interp1(X,Y{i}{j},PT.swp(2,end),'spline','extrap');
    end % end sweep
    %interpolate by aspect ratio for each graph under taper ratio
    Y2(i) = interp1(X2,Y1{i},PT.AR(end),'linear','extrap');
end %end aspect ratio
%interpolate by taper ratio
aol_theta = interp1(X3,Y2,PT.TR(end),'spline');

%Datcomom Figure 4.1.3.1.5
%Correct for Subsonic Mach Effects
% T/C Ratio
M2 = [0, 7, 8, 9, 10, 12, 14, 16];
% M*Cos(PT.swp(2,end))
MX = [ 0.00,  0.10,  0.20,  0.30,  0.40,  0.45,  0.50,  0.55, ...
    0.60,  0.65,  0.70,  0.75,  0.80,  0.85,  0.90,  0.95];
% daol_M/daol_M
MY = {[1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
    1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000]
    [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
    1.000, 1.000, 1.000, 1.000, 0.995, 0.990, 0.850, 0.700]
    [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
    1.000, 1.000, 1.000, 1.000, 0.850, 0.700, 0.000,-0.650]
    [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
    1.000, 1.000, 1.000, 0.950, 0.800, 0.000,-0.600,-3.500]
    [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
    1.000, 1.000, 1.000, 0.800, 0.250,-1.600,-3.400,-6.000]
    [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
    1.000, 0.850, 0.650,-0.250,-2.000,-3.900,-7.000,-7.000]
    [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 0.900, ...
    0.750, 0.500 -0.100,-1.400,-3.200,-6.000,-9.000,-12.00]
    [1.000, 1.000, 1.000, 1.000, 1.000, 0.900, 0.800, 0.650, ...
    0.400,-0.150,-1.100 -2.600,-4.350,-7.350,-10.350,-13.35]};

nmM2 = length(M2);
Y3 = zeros(size(nmM2));
MCS4 = M*cosd(PT.swp(2,end));
for i=1:nmM2
    %interpolate by MCS4 for each curve
    Y3(i) = interp1(MX,MY{i},MCS4,'pchip','extrap');
end
aol_theta_M = interp1(M2,Y3,PT.TC,'linear','extrap');

%end

%Fix Alpha Zero Lift
for n=1:length(PT.alpha0)
    PT.alpha0L(n)=(PT.alpha0(n)+aol_theta*PT.TWISTA)*aol_theta_M;
end
PT.alpha0L = (PT.alpha0L(1)+PT.alpha0L(end))/2;

%%%%%%%%%%%%%%%%%%%%%% Fix Moment Coefficient %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%from Glenn Greiner (AE Professor at ERAU Daytona Beach)
%
%function [dCm_theta, dCm_theta_M] = Fig_dcm_theta(PT.swp(2,end), A, Taper, M)
%[dCm_theta, dCm_theta_M] = Fig_dcm_theta(PT.swp(2,end), A, Taper, M)
%Change in piPT.TChing moment (CM) due to twist (theta), Datcomom
%Figure 4.1.4.1.5 including Mach effects, Datcomom Figure 4.1.4.1.6
%Input
%PT.swp(1,end) = Leading edge sweep
%Aspect Ratio
%PT.TR(end) = Taper ratio
%M = Subsonic Mach Number
%Output
%dCm_theta   = Change in piPT.TChing moment due to twist
%dCm_theta_M = Correction for compressibility effects (Mach)

%Datcomom Figure 4.1.4.1.5-A, B and C
%Taper Ratio
X3 = [0.,.5,1.];
%Aspect Ratio
X2 = [10.,8.,6.,3.5,1.5];
%c/4 Sweep
X = [-45.,-40.,-35.,-30.,-25.,-20.,-15.,-10.,-5., 0., ...
    5.,10.,15.,20.,25.,30.,35.,40.,45.,50.,55.,60.];
%dCmo_theta
Y = {{[.0116, .0100, .0085, .0072, .0060, .0048, .0036, .0024, ...
    .0012, .0000,-.0012,-.0024,-.0037,-.0050,-.0063,-.0076, ...
    -.0090,-.0104,-.0118,-.0131,-.0145,-.0159]
    [.0081, .0070, .0061, .0051, .0042, .0034, .0025, .0017, ...
    .0008, .0000,-.0009,-.0017,-.0026,-.0035,-.0045,-.0055, ...
    -.0065,-.0076,-.0086,-.0097,-.0108,-.011]
    [.0052, .0045, .0039, .0033, .0027, .0022, .0016, .0011, ...
    .0005, .0000,-.0005,-.0011,-.0017,-.0023,-.0029,-.0035, ...
    -.0042,-.0049,-.0057,-.0063,-.0070,-.0078]
    [.0022, .0019, .0016, .0014, .0011, .0009, .0007, .0004, ...
    .0002, .0000,-.0002,-.0004,-.0007,-.0009,-.0012,-.0014, ...
    -.0017,-.0021,-.0024,-.0027,-.0032,-.0036];
    [.0005, .0004, .0004, .0003, .0002, .0002, .0001, .0001, ...
    .0000, .0000,-.0000,-.0001,-.0001,-.0002,-.0002,-.0003, ...
    -.0004,-.0004,-.0005,-.0006,-.0007,-.0008]};
    
    {[.0204, .0177, .0152, .0128, .0105, .0083, .0061, .0041, ...
    .0020, .0000,-.0020,-.0040,-.0060,-.0080,-.0100,-.0121, ...
    -.0141,-.0162,-.0182,-.0208,-.0232,-.0257]
    [.0144, .0125, .0107, .0090, .0073, .0058, .0043, .0028, ...
    .0014, .0000,-.0014,-.0028,-.0042,-.0056,-.0071,-.0086, ...
    -.0102,-.0117,-.0133,-.0153,-.0172,-.0193]
    [.0091, .0078, .0066, .0055, .0045, .0035  .0026, .0017, ...
    .0009, .0000,-.0009,-.0017,-.0026,-.0035,-.0044,-.0054, ...
    -.0064,-.0075,-.0087,-.0099,-.0113,-.0128]
    [.0036, .0030, .0026, .0021, .0017, .0013, .0010, .0007, ...
    .0003, .0000,-.0003 -.0007,-.0010,-.0013,-.0017,-.0021, ...
    -.0025,-.0030,-.0036,-.0043,-.0050,-.0058]
    [.0007, .0006, .0005, .0004, .0003, .0003, .0002, .0001, ...
    .0001, .0000,-.0001,-.0001,-.0002,-.0003,-.0003,-.0004, ...
    -.0005,-.0006,-.0007,-.0008,-.0009,-.0010]};
    
    {[.0218, .0189, .0162, .0135, .0111, .0087, .0064, .0042, ...
    .0021, .0000,-.0020,-.0041,-.0061,-.0081,-.0101,-.0121, ...
    -.0141,-.0162,-.0182,-.0202,-.0222,-.0243]
    [.0154, .0133, .0113, .0095, .0077, .0060, .0044, .0029, ...
    .0014, .0000,-.0014,-.0028,-.0043,-.0057,-.0072,-.0087, ...
    -.0102,-.0117,-.0133,-.0148,-.0163,-.0179]
    [.0097, .0083, .0070, .0058, .0047, .0037, .0027, .0018, ...
    .0009, .0000,-.0009,-.0018,-.0027,-.0036,-.0045,-.0055, ...
    -.0065,-.0075,-.0086,-.0098,-.0108,-.0119]
    [.0038, .0032, .0027, .0022, .0018, .0014, .0010, .0007, ...
    .0003, .0000,-.0003,-.0007,-.0010,-.0014,-.0018,-.0022, ...
    -.0026,-.0031,-.0036,-.0043,-.0050,-.0057]
    [.0008, .0006, .0005, .0004, .0003, .0003, .0002, .0001, ...
    .0001, .0000,-.0001,-.0001,-.0002,-.0003,-.0003,-.0004, ...
    -.0005,-.0006,-.0007,-.0008,-.0009,-.0010]}};

%perform interpolation
nmY = length(X3);
nmX2 = length(X2);
Y1 = cell(size(nmY));
Y2 = zeros(size(nmX2));

for i=1:nmY
    for j=1:nmX2
        %interpolate by sweep for each graph under each aspect ratio
        %and taper ratio
        Y1{i}(j) = interp1(X,Y{i}{j},PT.swp(2,end),'spline','extrap');
    end % end sweep
    %interpolate by aspect ratio for each graph under taper ratio
    Y2(i) = interp1(X2,Y1{i},PT.AR(end),'linear','extrap');
end %end aspect ratio
%interpolate by taper ratio
dCm_theta = interp1(X3,Y2,PT.TR(end),'spline');

%Datcomom Figure 4.1.4.1.6
%Correct for Subsonic Mach Effects
MX = [0.000, 0.050, 0.100, 0.150, 0.200, 0.250, ...
    0.300, 0.350, 0.400, 0.450, 0.500, 0.550, ...
    0.600, 0.650, 0.700, 0.750, 0.800, 0.850, 0.900];
MY = [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
    1.005, 1.017, 1.031, 1.050, 1.072, 1.101, ...
    1.132, 1.162, 1.197, 1.237, 1.287, 1.355, 1.445];
dCm_theta_M = interp1(MX,MY,M,'spline');

%Moment Coefficient
for n=1:length(PT.Cm_ac)
    PT.Cm(n)=PT.Cm_ac(n)*PT.AR(end)*cosd(PT.swp(2,end))^2/(PT.AR(end)+2*cosd(PT.swp(2,end)));
    PT.Cm(n)=(PT.Cm(n)+dCm_theta*PT.TWISTA)*dCm_theta_M;
end
PT.Cm = (PT.Cm(1)+PT.Cm(end))/2;

%%%%%%%%%%%%%%%%%%%%%%%% Fix Aerodynamic Center %%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%from Glenn Greiner (AE Professor at ERAU Daytona Beach)
%
%function xac_cr = Fig_xac_cr(PT.swp(1,end),A,Taper,M)
%xac_cr = Fig_xac_cr(Sweep_LE, Aspect Ratio, Taper Ratio, Mach Number)
%Aerodynamic Center with respect to chord root, Datcomom Figure 4.1.4.2-26
%Input
%PT.swp(1,end) = Leading edge sweep
%Aspect Ratio
%PT.TR(end) = Taper ratio
%M = Mach
%Output
%xac_cr = Aerodynamic center location on the chord root in chord roots

%Taper Ratio
X3 = [0., .2, .25, .33, .5, 1.];
%Aspect Ratio
X2 = [1., 2., 3., 4., 5., 6.];
%c/4 Sweep
X1 = [0., .2, .4, .6, .8, 1.];
%Subsonic Range 0 - 1
Y1 = {{[ .250, .245, .240, .235, .230, .225] ...
    [ .335, .335, .335, .335, .335, .335] ...
    [ .420, .430, .435, .445, .450, .455] ...
    [ .500, .515, .530, .540, .550, .560] ...
    [ .580, .600, .630, .645, .660, .680] ...
    [ .680, .695, .720, .740, .760, .780]};
    
    {[ .285, .275, .270, .265, .260, .255] ...
    [ .400, .410, .415, .415, .415, .410] ...
    [ .510, .530, .535, .540, .545, .550] ...
    [ .640, .650, .660, .675, .685, .690] ...
    [ .750, .765, .780, .785, .800, .815] ...
    [ .870, .880, .895, .905, .920, .930]};
    
    {[ .300, .295, .285, .280, .275, .265] ...
    [ .420, .420, .425, .425, .425, .430] ...
    [ .545, .550, .560, .565, .575, .580] ...
    [ .670, .680, .690, .700, .710, .720] ...
    [ .795, .805, .815, .830, .840, .850] ...
    [ .925, .945, .960, .965, .975, .980]};
    
    {[ .325, .320, .315, .305, .300, .290] ...
    [ .460, .460, .460, .460, .455, .455] ...
    [ .595, .600, .600, .600, .610, .620] ...
    [ .735, .740, .750, .760, .765, .775] ...
    [ .885, .890, .895, .900, .910, .925] ...
    [1.045,1.050,1.050,1.060,1.065,1.075]};
    
    {[ .355, .350, .345, .340, .330, .320] ...
    [ .530, .530, .525, .525, .520, .520] ...
    [ .700, .700, .700, .705, .710, .710] ...
    [ .880, .880, .885, .890, .890, .895] ...
    [1.040,1.045,1.050,1.055,1.060,1.065] ...
    [1.200,1.205,1.210,1.215,1.225,1.230]};
    
    {[ .510, .490, .480, .470, .460, .450] ...
    [ .750, .750, .750, .750, .745, .740] ...
    [1.000,1.000,1.000,1.000,1.000,1.000] ...
    [1.250,1.250,1.250,1.250,1.250,1.250] ...
    [1.500,1.500,1.500,1.490,1.490,1.490] ...
    [1.740,1.740,1.740,1.730,1.730,1.730]}};

% Subsonic Range 1 - 0
Y2 = {{[ .165, .180, .200, .210, .220, .225] ...
    [ .335, .335, .335, .335, .335, .335] ...
    [ .500, .480, .465, .460, .460, .455] ...
    [ .670, .625, .595, .580, .575, .560] ...
    [ .830, .750, .730, .705, .695, .680] ...
    [ .990, .860, .835, .810, .795, .780]};
    
    {[ .200, .215, .230, .240, .250, .255] ...
    [ .400, .400, .400, .405, .410, .410] ...
    [ .600, .580, .565, .560, .555, .550] ...
    [ .795, .760, .735, .715, .700, .690] ...
    [ .970, .910, .870, .840, .825, .815] ...
    [1.150,1.050,1.000, .965, .940, .930]};
    
    {[ .230, .240, .245, .250, .260, .265] ...
    [ .415, .420, .425, .425, .430, .430] ...
    [ .630, .615, .600, .590, .585, .580] ...
    [ .830, .785, .760, .740, .730, .720] ...
    [1.030, .950, .905, .880, .865, .850] ...
    [1.250,1.090,1.050,1.015, .990, .980]};
    
    {[ .220, .240, .250, .265, .280, .290] ...
    [ .440, .445, .450, .450, .455, .455] ...
    [ .670, .655, .640, .630, .625, .620] ...
    [ .880, .830, .805, .790, .780, .775] ...
    [1.070,1.000, .960, .940, .935, .925] ...
    [1.270,1.170,1.120,1.100,1.085,1.075]};
    
    {[ .250, .270, .295, .310, .315, .320] ...
    [ .500, .505, .510, .515, .520, .520] ...
    [ .750, .740, .730, .720, .715, .710] ...
    [ .980, .940, .915, .900, .900, .895] ...
    [1.190,1.120,1.090,1.080,1.070,1.065] ...
    [1.380,1.300,1.270,1.250,1.240,1.230]};
    
    {[ .340, .380, .410, .430, .440, .450] ...
    [ .680, .700, .720, .730, .730, .740] ...
    [ .950, .980,1.000,1.000,1.000,1.000] ...
    [1.200,1.230,1.250,1.250,1.250,1.250] ...
    [1.440,1.470,1.480,1.480,1.490,1.490] ...
    [1.680,1.710,1.710,1.720,1.720,1.730]}};

%Supersonic Range 0 - 1
Y3 = {{[ .165, .210, .250, .290, .310, .345] ...
    [ .335, .365, .390, .415, .445, .470] ...
    [ .500, .540, .560, .560, .560, .560] ...
    [ .670, .670, .670, .670, .670, .670] ...
    [ .830, .775, .775, .775, .775, .775] ...
    [ .990, .930, .895, .895, .895, .895]};
    
    {[ .200, .230, .280, .305, .335, .360] ...
    [ .400, .445, .485, .500, .520, .530] ...
    [ .600, .630, .650, .660, .665, .665] ...
    [ .795, .800, .800, .805, .810, .815] ...
    [ .970, .965, .955, .955, .955, .955] ...
    [1.150,1.135,1.120,1.100,1.100,1.105]};
    
    {[ .230, .275, .300, .330, .350, .370] ...
    [ .415, .470, .500, .530, .545, .550] ...
    [ .630, .670, .680, .685, .690, .690] ...
    [ .830, .835, .835, .840, .845, .850] ...
    [1.030,1.015,1.005,1.000,1.005,1.010] ...
    [1.250,1.225,1.200,1.170,1.165,1.160]};
    
    {[ .220, .280, .315, .345, .375, .390] ...
    [ .440, .500, .535, .560, .570, .580] ...
    [ .670, .700, .720, .725, .740, .740] ...
    [ .880, .885, .895, .900, .900, .900] ...
    [1.070,1.070,1.075,1.075,1.080,1.080] ...
    [1.270,1.260,1.260,1.255,1.255,1.255]};
    
    {[ .250, .300, .330, .380, .415, .445] ...
    [ .500, .560, .600, .620, .635, .640] ...
    [ .750, .780, .800, .820, .820, .825] ...
    [ .980, .990,1.000,1.020,1.020,1.020] ...
    [1.190,1.200,1.200,1.210,1.220,1.225] ...
    [1.380,1.390,1.400,1.410,1.420,1.420]};
    
    {[ .340, .380, .410, .460, .500, .540] ...
    [ .680, .700, .730, .770, .790, .840] ...
    [ .950, .990,1.010,1.050,1.080,1.120] ...
    [1.200,1.240,1.290,1.330,1.370,1.420] ...
    [1.440,1.500,1.550,1.610,1.670,1.720] ...
    [1.680,1.760,1.820,1.890,1.950,2.020]}};

%Supersonic Range 1 - 0
Y4 = {{[ .415, .410, .400, .385, .370, .345] ...
    [ .500, .500, .495, .485, .480, .470] ...
    [ .585, .580, .580, .575, .570, .560] ...
    [ .670, .670, .670, .670, .670, .670] ...
    [ .750, .750, .755, .760, .765, .775] ...
    [ .830, .840, .845, .855, .870, .895]};
    
    {[ .460, .455, .445, .420, .390, .360] ...
    [ .575, .575, .570, .560, .545, .530] ...
    [ .695, .695, .690, .685, .680, .665] ...
    [ .800, .805, .805, .810, .815, .815] ...
    [ .920, .930, .935, .945, .970, .955] ...
    [1.040,1.045,1.050,1.075,1.110,1.105]};
    
    {[ .475, .465, .450, .430, .400, .370] ...
    [ .600, .600, .595, .585, .575, .550] ...
    [ .725, .730, .730, .725, .715, .690] ...
    [ .850, .850, .855, .865, .870, .850] ...
    [ .970, .975, .980,1.000,1.020,1.010] ...
    [1.110,1.110,1.110,1.130,1.180,1.160]};
    
    {[ .500, .490, .470, .450, .425, .390] ...
    [ .640, .635, .630, .620, .600, .580] ...
    [ .770, .775, .780, .775, .765, .740] ...
    [ .920, .915, .920, .930, .935, .900] ...
    [1.050,1.055,1.060,1.080,1.105,1.080] ...
    [1.195,1.200,1.205,1.225,1.265,1.255]};
    
    {[ .550, .535, .525, .500, .475, .445] ...
    [ .720, .715, .710, .690, .670, .640] ...
    [ .890, .890, .890, .885, .870, .825] ...
    [1.060,1.050,1.050,1.060,1.065,1.020] ...
    [1.215,1.215,1.220,1.245,1.270,1.225] ...
    [1.380,1.380,1.395,1.420,1.470,1.420]};
    
    {[ .760, .730, .700, .650, .600, .540] ...
    [1.000,1.000, .970, .930, .890, .840] ...
    [1.240,1.230,1.230,1.220,1.190,1.120] ...
    [1.500,1.480,1.480,1.490,1.470,1.420] ...
    [1.750,1.720,1.730,1.760,1.780,1.720] ...
    [2.000,1.970,1.980,2.020,2.070,2.020]}};


nmY = length(X3);
nmX2 = length(X2);
Z1 = cell(size(nmY));
Z2 = zeros(size(nmX2));
AT = PT.AR(end)*tand(PT.swp(1,end));
if M <= 1
    B = sqrt(1 - M^2);
    if B == 0
        X0 = 1; Y0 = Y2;
    else
        X0 = tand(PT.swp(1,end))/B;
        if X0 > 0 || X0 <= 1; Y0 = Y1; end
        if X0 > 1; X0 = 1/X0; Y0 = Y2; end
    end
end
if M >= 1
    B = sqrt(M^2 - 1);
    if B == 0
        X0 = 1; Y0 = Y3;
    else
        X0 = tand(PT.swp(1,end))/B;
        if X0 > 0 || X0 <= 1; Y0 = Y4; end
        if X0 > 1; X0 = 1/X0; Y0 = Y3; end
    end
end
for i=1:nmY
    for j=1:nmX2
        %interpolate by sweep for each graph under each aspect ratio
        %and taper ratio
        Z1{i}(j) = interp1(X1,Y0{i}{j},X0,'spline','extrap');
    end
    %interpolate by aspect ratio for each graph under taper ratio
    Z2(i) = interp1(X2,Z1{i},AT,'linear','extrap');
end
%interpolate by taper ratio
xac_cr = interp1(X3,Z2,PT.TR(end),'spline');

%Aerodynamic Center
PT.x_ac=(xac_cr*PT.CHRDR-PT.xmac)/PT.cbar(end);

%Back to Degrees
PT.a=PT.a*pi/180;

%%%%%%%%%%%%%%%%%%%%%%%%% Long_Prop_Eff %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

if isfield(PT,'Propeller')
    
    %********** UPDATE ****************
    
    %function Prop = Long_Prop_Eff(PT.TC, B75R, nb, xp_crw, A)
    %(Long_Prop_Eff) Longitudinal Propeller Effects per NACA WR L-25
    %Prop = Prop_eff(PT.TC, B75R, nb, xp_cwr)
    %Input(s):
    %   PT.TC     = Thrust Coefficient, PT.TC = Tp/(rho*V^2*Dp^2)
    %   B75R   = Prop geomePT.TR(end)ic piPT.TCh angle @ 0.75R
    %   nb     = Number of prop blades
    %   xp_crw = prop location fwd of wing 25%cr in wing root chords
    %   A      = Wing Aspect ratio
    %Output(s)
    %   Prop.f       = Correction factor for prop power PT.TC
    %   Prop.CNaPtco = Prop normal force lift-curve slope @ PT.TC = 0
    %   Prop.dBda    = Prop upwash dBda > 0 or downwash dBda < 0 gradient
    %   Prop.A       = Prop downwash factor on the horizontal tail
    %   Prop.B       = Prop downwash factor on the horizontal tail
    %   Prop.depda   = Prop downwash gradient at horizontial tail
    %                  depda = A + B*CNaPPT.TCo
    
    %Variation of "f" wrt PT.TC
    Prop.f = 1;
    % PT.TC
    X = [0.0, 0.20,0.40 0.60,0.80,1.00,1.20,1.40,1.60,1.80,2.00];
    % f
    Y = [1.00,1.18,1.31,1.41,1.50,1.60,1.68,1.75,1.81,1.85,1.90];
    % Interpolate
    Prop.f = interp1(X,Y,PT.TC,'spline');
    
    %Variation of CNaPPT.TCo (per rad) wrt B75R
    Prop.CNaPPT.TCo = 0;
    X = [15,20,25,30,35,40,45,50,55,60];
    %Number of prop blades = 2
    Y2 = [0.080,0.100,0.120,0.125,0.140,0.150,0.160,0.170,0.175,0.180];
    %Number of prop blades = 3
    Y3 = [0.120,0.140,0.160,0.180,0.200,0.220,0.235,0.250,0.260,0.270];
    %Number of prop blades = 4
    Y4 = [0.145,0.175,0.205,0.235,0.255,0.275,0.300,0.320,0.335,0.350];
    %Number of prop blades = 6
    Y6 = [0.190,0.245,0.275,0.320,0.355,0.385,0.430,0.445,0.475,0.500];
    %interpolate
    if nb == 2; Prop.CNaPPT.TCo = interp1(X,Y2,B75R,'spline','extrap'); end
    if nb == 3; Prop.CNaPPT.TCo = interp1(X,Y3,B75R,'spline','extrap'); end
    if nb == 4; Prop.CNaPPT.TCo = interp1(X,Y4,B75R,'spline','extrap'); end
    if nb == 6; Prop.CNaPPT.TCo = interp1(X,Y6,B75R,'spline','extrap'); end
    
    %Prop upwash (1+dep/da) factor dBda > 1
    Prop.dBda = 0;
    X1 = [6, 9, 12];
    if xp_crw > 0;
        X = [.3, .4, .5, .6, .7 .8, .9, 1.0, 1.1, 1.2, 1.3, 1.4];
        % Wing aspect ratio 6, 9 and 12
        Y = {[1.900, 1.650, 1.500, 1.400, 1.300, 1.250, 1.220, 1.195, ...
            1.150, 1.140, 1.130, 1.120];
            [2.025, 1.800, 1.600, 1.475, 1.400, 1.350, 1.300, 1.250, ...
            1.220, 1.200, 1.197, 1.180];
            [2.150, 1.880, 1.700, 1.550, 1.450, 1.380, 1.320, 1.280, ...
            1.250, 1.225, 1.215, 1.200]};
        %Interpolate
        for j=1:3
            Y1(j) = interp1(X,Y{j},xp_crw,'spline','extrap');
        end
        Prop.dBda = interp1(X1,Y1,A,'spline','extrap');
    end
    %Prop downwash (1-dep/da) factor dBda < 1
    if xp_crw < 0;
        X = [-0.75,-0.8,-0.9,-1.0,-1.1,-1.2,-1.3,-1.4,-1.5,-1.6, ...
            -1.7 ,-1.8,-1.9,-2.0];
        % Wing aspect ratio 6, 9 and 12
        Y = {[0, 0.080,0.180,0.250,0.275,0.325,0.350,0.380,0.395,0.400, ...
            0.415,0.420,0.425,0.430];
            [0, 0.100,0.225,0.300,0.350,0.400,0.425,0.450,0.475,0.500, ...
            0.525,0.550,0.560,0.575];
            [0, 0.150,0.250,0.350,0.400,0.450,0.457,0.500,0.550,0.560, ...
            0.570,0.580,0.590,0.600]};
        Y1 = zeros(3);
        for j=1:3
            Y1(j) = interp1(X,Y{j},xp_crw,'spline','extrap');
        end
        Prop.dBda = interp1(X1,Y1,PT.AR(end),'spline','extrap');
    end
    
    %Propeller Downwash Factors, A and B
    Prop.depda = 0;
    % PT.TC
    X = [0.0, 0.2, 0.4, 0.6, 0.8,1.0, 1.2, 1.4, 1.6, 1.8, 2.0];
    % Prop downwash factor A,B
    YA=[0.000,0.120,0.200,0.275,0.325,0.375,0.400,0.435,0.460,0.480,0.500];
    YB=[0.250,0.260,0.255,0.245,0.235,0.200,0.215,0.205,0.200,0.195,0.190];
    % Interpolate
    Prop.A = interp1(X,YA,PT.TC,'spline');
    Prop.B = interp1(X,YB,PT.TC,'spline');
    Prop.depda = Prop.A + Prop.B*Prop.CNaPPT.TCo;
    
end


end

